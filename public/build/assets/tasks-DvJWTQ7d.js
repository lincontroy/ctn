import{r as a,j as e}from"./app-DT_4Y409.js";import{A as T,X as C}from"./app-layout-Dm49Z596.js";import{E as S,P as E,T as _}from"./trash-2-BXkzaiLC.js";/* empty css            */import"./button-DRPktjTk.js";import"./index-G9T5zEPV.js";import"./index-Bam0Hizw.js";const D=[{title:"Tasks",href:"/tasks"}];function L(){const[x,j]=a.useState([]),[y,f]=a.useState([]),[r,c]=a.useState({title:"",description:"",status:"pending",user_id:"",deadline:""}),[N,o]=a.useState(!1),[d,g]=a.useState(!1),[l,u]=a.useState(null),[h,i]=a.useState(null),[z,A]=a.useState(!1),p=async()=>{try{const t=await(await fetch("/api/tasks")).json();j(t)}catch{i({type:"error",message:"Failed to load tasks"})}},k=async()=>{try{const t=await(await fetch("/api/users")).json();f(t)}catch{i({type:"error",message:"Failed to load users"})}};a.useEffect(()=>{p(),k()},[]);const n=s=>{c({...r,[s.target.name]:s.target.value})},w=async()=>{const s=l?"PUT":"POST",t=l?`/api/tasks/${l.id}`:"/api/tasks";try{if(!(await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Failed to save task");i({type:"success",message:`Task ${l?"updated":"created"} successfully!`}),o(!1),u(null),c({title:"",description:"",status:"pending",user_id:"",deadline:""}),p()}catch(b){i({type:"error",message:b.message})}},v=async s=>{confirm("Are you sure you want to delete this task?")&&(await fetch(`/api/tasks/${s}`,{method:"DELETE"}),i({type:"success",message:"Task deleted successfully"}),p())},m=(s,t=!1)=>{s?(c({title:s.title,description:s.description||"",status:s.status,user_id:s.user_id.toString(),deadline:s.deadline||""}),u(s),g(t)):(c({title:"",description:"",status:"pending",user_id:"",deadline:""}),u(null),g(!1)),o(!0)};return e.jsx(T,{breadcrumbs:D,children:e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900",children:[h&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded shadow-md ${h.type==="success"?"bg-green-500":"bg-red-500"} text-white`,children:h.message}),e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 dark:text-white",children:"Tasks"}),e.jsx("button",{onClick:()=>m(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md",children:"+ Add Task"})]}),e.jsx("div",{className:"p-4",children:e.jsxs("table",{className:"min-w-full table-auto border text-sm dark:text-white",children:[e.jsx("thead",{className:"bg-gray-200 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"Title"}),e.jsx("th",{className:"p-2 border",children:"User"}),e.jsx("th",{className:"p-2 border",children:"Status"}),e.jsx("th",{className:"p-2 border",children:"Deadline"}),e.jsx("th",{className:"p-2 border text-center",children:"Actions"})]})}),e.jsxs("tbody",{children:[x.map(s=>{var t;return e.jsxs("tr",{className:"border hover:bg-gray-50 dark:hover:bg-gray-800",children:[e.jsx("td",{className:"p-2 border",children:s.title}),e.jsx("td",{className:"p-2 border",children:(t=s.user)==null?void 0:t.name}),e.jsx("td",{className:"p-2 border capitalize",children:s.status.replace("_"," ")}),e.jsx("td",{className:"p-2 border",children:s.deadline||"â€”"}),e.jsx("td",{className:"p-2 border text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>m(s,!0),className:"text-blue-500",children:e.jsx(S,{size:18})}),e.jsx("button",{onClick:()=>m(s),className:"text-green-500",children:e.jsx(E,{size:18})}),e.jsx("button",{onClick:()=>v(s.id),className:"text-red-500",children:e.jsx(_,{size:18})})]})})]},s.id)}),x.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-4",children:"No tasks found."})})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md relative",children:[e.jsx("button",{onClick:()=>o(!1),className:"absolute top-2 right-2 text-gray-600 hover:text-red-500",children:e.jsx(C,{size:20})}),e.jsx("h3",{className:"text-xl mb-4 text-gray-800 dark:text-white",children:d?"Task Details":l?"Edit Task":"New Task"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{name:"title",value:r.title,onChange:n,placeholder:"Task Title",disabled:d,className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"}),e.jsx("textarea",{name:"description",value:r.description,onChange:n,placeholder:"Description",disabled:d,className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"}),e.jsxs("select",{name:"user_id",value:r.user_id,onChange:n,disabled:d,className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"",children:"Assign to user"}),y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("select",{name:"status",value:r.status,onChange:n,disabled:d,className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"})]}),e.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300",children:"Deadline"}),e.jsx("input",{name:"deadline",type:"date",value:r.deadline,onChange:n,disabled:d,className:"w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600"}),!d&&e.jsx("button",{onClick:w,className:"bg-blue-600 hover:bg-blue-700 text-white w-full py-2 rounded",children:l?"Update":"Create"})]})]})})]})})}export{L as default};
